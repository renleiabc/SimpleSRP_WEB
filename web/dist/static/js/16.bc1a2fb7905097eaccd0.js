webpackJsonp([16],{QOhf:function(n,t,e){(n.exports=e("UTlt")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},WrLu:function(n,t,e){var a=e("QOhf");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("FIqI")("ef66cb42",a,!0,{})},j3MC:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("IHPB"),s=e.n(a),i=e("4YfN"),o=e.n(i),r=e("aA9S"),l=e.n(r),c=e("v46e"),g={name:"announcement",data:function(){return{createStorageDialog:!1,states:"",isDisabel:!1,linTabData:"",linUrl:"",createStorage:{storage_name:"",project_id:"",storage_description:""},proList:[],arcProList:[],storageIdList:[],pageSize:3,pickerOptions:{shortcuts:[{text:this.$t("views.systemManagement.recentOneWeek"),onClick:function(n){var t=new Date,e=new Date;e.setTime(e.getTime()-6048e5),n.$emit("pick",[e,t])}},{text:this.$t("views.systemManagement.recentOneMonth"),onClick:function(n){var t=new Date,e=new Date;e.setTime(e.getTime()-2592e6),n.$emit("pick",[e,t])}},{text:this.$t("views.systemManagement.recentThreeMonth"),onClick:function(n){var t=new Date,e=new Date;e.setTime(e.getTime()-7776e6),n.$emit("pick",[e,t])}}]},tableData:{msg:[],url:"/storage/storagelist",loading:!0,Pagination:{page:1,total_count:5},sel:{php_name:"",sort:"",project_id:"",is_init:2,full_date:[]}}}},methods:{changeStorage:function(){this.createStorageDialog=!0},saveStorage:function(){var n=this;if(""===this.createStorage.storage_name)return this.$message({message:this.$t("views.storageManagement.valid.notNullName"),type:"error"}),!1;if(""===this.createStorage.project_id)return this.$message({message:this.$t("views.storageManagement.valid.notNullPro"),type:"error"}),!1;if(!Object(c.a)(this.createStorage.storage_name)||this.createStorage.storage_name.length<3)return this.$message({message:this.$t("views.storageManagement.valid.regStr"),type:"error"}),!1;if(/^[\s]+$/.test(this.createStorage.storage_description))return this.$message({message:"只输入空格不可提交",type:"error"}),!1;this.isDisabel=!0;var t={is_init:this.tableData.sel.is_init,php_name:this.createStorage.storage_name,project_id:this.createStorage.project_id,describe:this.createStorage.storage_description};this.$post("/storage/storagecreate",{Storage:t}).then(function(t){200===t.code?(n.$message({message:n.$t("views.notification.saved"),type:"success"}),n.createStorageDialog=!1,n.getActiveTab("tableData")):n.isDisabel=!1})},clearCreatInfo:function(){this.isDisabel=!1,this.createStorage.storage_description="",this.createStorage.project_id="",this.createStorage.storage_name=""},projectLog:function(n){this.$router.push({name:"storageProjectLog",query:{storage_id:n}})},sortTable:function(n){"descending"===n.order?this.tableData.sel.sort="-"+n.prop:this.tableData.sel.sort=n.prop,this.initMsg()},saveAuthenticate:function(n){var t=document.createElement("a");t.href=window.Simple.php+"/v1/storage/downloadkey?access-token="+JSON.parse(sessionStorage.getItem("userinfo")).access_token+"&storage_id="+n.id,document.body.appendChild(t),setTimeout(function(n){t.click(),document.body.removeChild(t)},5)},getActiveTab:function(n){this.createStorage.storage_name="",this.createStorage.storage_description="",this.createStorage.project_id="",this.linTabData=n,this.linUrl=this[n].url,this.initMsg()},clearSearch:function(n){for(var t in this[n].sel)"is_init"!==t&&(this[n].sel[t]="");void 0!==this[n].Pagination&&(this[n].Pagination.page=1),this.getActiveTab(n)},doSearch:function(n){void 0!==this[n].Pagination&&(this[n].Pagination.page=1),this.getActiveTab(n)},changePage:function(n){this.getActiveTab(n)},initMsg:function(){var n=this;this[this.linTabData].loading=!0;var t={};void 0!==this[this.linTabData].Pagination&&(t=l()({},this[this.linTabData].Pagination,{count:this.pageSize})),void 0!==this[this.linTabData].sel&&(this[this.linTabData].sel.full_date&&2===this[this.linTabData].sel.full_date.length?(this[this.linTabData].sel.start_time=this[this.linTabData].sel.full_date[0],this[this.linTabData].sel.end_time=this[this.linTabData].sel.full_date[1]):(this[this.linTabData].sel.start_time="",this[this.linTabData].sel.end_time=""),t=l()({},t,this[this.linTabData].sel)),this.$post(this[this.linTabData].url+"?sort="+t.sort,{StorageSearch:o()({},t),page:t.page}).then(function(t){var e=t.data.storage_list;n[n.linTabData].msg=[].concat(s()(e)),void 0!==n[n.linTabData].Pagination&&(n[n.linTabData].Pagination.total_count=t.data.total_count),n.pageSize=t.data.per_page,n[n.linTabData].loading=!1})},fileManage:function(n){this.$router.push({name:"proStorageDetail",query:{id:n,is_init:this.tableData.sel.is_init}})},deleteStorage:function(n){var t=this;this.mixinConfirm("/storage/storagedelete",{storage_id:[n],force:0}).then(function(n){n&&t.getActiveTab("tableData")})}},created:function(){var n=this;this.$get("/storage/progectlist",{guidangshow:1}).then(function(t){200===t.code&&(n.proList=t.data)}),this.$get("/storage/progectlist",{guidangshow:0}).then(function(t){200===t.code&&(n.arcProList=t.data)}),this.role=JSON.parse(sessionStorage.getItem("userinfo")).role,this.getActiveTab("tableData")}},u={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"announcement"},[e("div",{staticClass:"tab-select"},[e("div",[e("span",{staticClass:"tab-select-title"},[n._v(n._s(n.$t("views.storageManagement.storage.storageName")))]),n._v(" "),e("el-input",{staticClass:"views-input-text",attrs:{placeholder:n.$t("views.storageManagement.storage.storageName")},model:{value:n.tableData.sel.php_name,callback:function(t){n.$set(n.tableData.sel,"php_name",t)},expression:"tableData.sel.php_name"}})],1),n._v(" "),e("div",[e("span",{staticClass:"tab-select-title"},[n._v(n._s(n.$t("views.table.createTime")))]),n._v(" "),e("el-date-picker",{attrs:{type:"daterange",editable:!1,"range-separator":"-","picker-options":n.pickerOptions,"value-format":"yyyy-MM-dd","start-placeholder":n.$t("views.button.startDate"),"end-placeholder":n.$t("views.button.endDate")},model:{value:n.tableData.sel.full_date,callback:function(t){n.$set(n.tableData.sel,"full_date",t)},expression:"tableData.sel.full_date"}})],1),n._v(" "),e("div",[e("span",{staticClass:"tab-select-title"},[n._v(n._s(n.$t("views.storageManagement.storage.belongSpace")))]),n._v(" "),e("el-select",{attrs:{clearable:"",filterable:"",placeholder:n.$t("views.imageManagement.chose")},model:{value:n.tableData.sel.project_id,callback:function(t){n.$set(n.tableData.sel,"project_id",t)},expression:"tableData.sel.project_id"}},n._l(n.proList,function(n,t){return e("el-option",{key:t,attrs:{label:n.name,value:n.id}})}),1)],1),n._v(" "),e("div",[e("el-button",{staticClass:"btn light small",on:{click:function(t){return n.clearSearch("tableData")}}},[n._v(n._s(n.$t("views.button.reset")))]),n._v(" "),e("el-button",{staticClass:"btn light small",on:{click:function(t){return n.doSearch("tableData")}}},[n._v(n._s(n.$t("views.button.search")))])],1)]),n._v(" "),e("div",{staticClass:"controls-else"},[e("el-button",{staticClass:"view-btn-medium",on:{click:n.changeStorage}},[n._v(n._s(n.$t("views.storageManagement.storage.btnCreatePro")))])],1),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.tableData.loading,expression:"tableData.loading"}],staticClass:"tab-content",attrs:{data:n.tableData.msg,border:""},on:{"sort-change":n.sortTable}},[e("el-table-column",{attrs:{type:"index",label:n.$t("views.table.number"),width:"55","header-align":"center",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:n.$t("views.storageManagement.storage.storageName"),prop:"php_name","show-overflow-tooltip":"",sortable:"custom"},scopedSlots:n._u([{key:"default",fn:function(t){return[0==t.row.is_archive&&1==t.row.status?e("router-link",{staticClass:"link",attrs:{to:{name:"proStorageDetail",query:{id:t.row.id,is_init:n.tableData.sel.is_init}}}},[n._v(n._s(t.row.php_name))]):e("span",[n._v(n._s(t.row.php_name))])]}}])}),n._v(" "),e("el-table-column",{attrs:{prop:"created_at",width:"200",sortable:"custom",align:"center",label:n.$t("views.table.createTime")}}),n._v(" "),e("el-table-column",{attrs:{prop:"project_name","show-overflow-tooltip":"",label:n.$t("views.storageManagement.storage.belongSpace")}}),n._v(" "),e("el-table-column",{attrs:{label:"项目状态",align:"center",prop:"is_archive"},scopedSlots:n._u([{key:"default",fn:function(t){return[0==t.row.is_archive?e("span",[n._v("开发中")]):e("span",[n._v("已归档")])]}}])}),n._v(" "),e("el-table-column",{attrs:{prop:"describe","show-overflow-tooltip":"",label:n.$t("views.table.describe")},scopedSlots:n._u([{key:"default",fn:function(t){return[0==t.row.status?e("span",{staticStyle:{color:"#ff7989"}},[n._v("无效的存储空间")]):e("span",[n._v(n._s(t.row.describe))])]}}])}),n._v(" "),e("el-table-column",{attrs:{label:n.$t("views.table.operate"),width:"300"},scopedSlots:n._u([{key:"default",fn:function(t){return e("div",{staticClass:"options text-center"},[1==t.row.status?e("button",{staticClass:"btn",on:{click:function(e){return n.projectLog(t.row.id)}}},[n._v("\n          项目日志\n        ")]):n._e(),n._v(" "),1==t.row.status?e("button",{staticClass:"btn",on:{click:function(e){return n.fileManage(t.row.id)}}},[n._v("\n          "+n._s(n.$t("views.storageManagement.storage.btnFileManege"))+"\n        ")]):n._e(),n._v(" "),1==t.row.status?e("button",{staticClass:"btn",on:{click:function(e){return n.saveAuthenticate(t.row)}}},[n._v("\n          "+n._s(n.$t("views.storageManagement.storage.btnSaveAuthenticate"))+"\n        ")]):n._e(),n._v(" "),e("button",{staticClass:"del",on:{click:function(e){return n.deleteStorage(t.row.id)}}},[n._v("\n          "+n._s(n.$t("views.button.delete"))+"\n        ")])])}}])}),n._v(" "),e("div",{attrs:{slot:"empty"},slot:"empty"},[e("div",{staticClass:"views-empty"},[e("span",{staticClass:"views-empty-table"}),n._v(" "),e("p",{staticClass:"views-empty-text"},[n._v(n._s(n.$t("views.table.noData")))])])])],1),n._v(" "),e("el-pagination",{staticClass:"tab-page",attrs:{layout:"prev, pager, next","page-size":n.pageSize,"current-page":n.tableData.Pagination.page,total:n.tableData.Pagination.total_count},on:{"update:currentPage":function(t){return n.$set(n.tableData.Pagination,"page",t)},"update:current-page":function(t){return n.$set(n.tableData.Pagination,"page",t)},"current-change":function(t){return n.changePage("tableData")}}}),n._v(" "),e("el-dialog",{staticClass:"small",attrs:{title:n.$t("views.storageManagement.storage.btnCreatePro"),visible:n.createStorageDialog},on:{"update:visible":function(t){n.createStorageDialog=t},close:n.clearCreatInfo}},[e("div",[e("div",{staticClass:"create-storage"},[e("span",[e("i",{staticStyle:{color:"red"}},[n._v("*")]),n._v(n._s(n.$t("views.storageManagement.storage.spaceName")))]),n._v(" "),e("el-input",{attrs:{maxlength:"30"},model:{value:n.createStorage.storage_name,callback:function(t){n.$set(n.createStorage,"storage_name",t)},expression:"createStorage.storage_name"}})],1),n._v(" "),e("div",{staticClass:"create-storage"},[e("span",[e("i",{staticStyle:{color:"red"}},[n._v("*")]),n._v(n._s(n.$t("views.storageManagement.storage.selectSpace")))]),n._v(" "),e("el-select",{attrs:{placeholder:n.$t("views.imageManagement.chose")},model:{value:n.createStorage.project_id,callback:function(t){n.$set(n.createStorage,"project_id",t)},expression:"createStorage.project_id"}},n._l(n.arcProList,function(n){return e("el-option",{key:n.id,attrs:{label:n.name,value:n.id}})}),1)],1),n._v(" "),e("div",{staticClass:"create-storage"},[e("span",[n._v(n._s(n.$t("views.table.describe")))]),n._v(" "),e("el-input",{attrs:{type:"textarea",maxlength:"200",rows:"4"},model:{value:n.createStorage.storage_description,callback:function(t){n.$set(n.createStorage,"storage_description",t)},expression:"createStorage.storage_description"}})],1)]),n._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"medium"},on:{click:function(t){n.createStorageDialog=!1}}},[n._v(n._s(n.$t("views.button.cancel")))]),n._v(" "),e("el-button",{staticClass:"view-btn-medium",attrs:{disabled:n.isDisabel},on:{click:n.saveStorage}},[n._v(n._s(n.$t("views.button.save")))])],1)])],1)},staticRenderFns:[]};var p=e("C7Lr")(g,u,!1,function(n){e("WrLu")},"data-v-07daf807",null);t.default=p.exports}});